<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Container - Hiechoer</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Hiechoer</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Blog <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../">Qt</a>
</li>
                                    
<li >
    <a href="../../cpp/">C++</a>
</li>
                                    
<li >
    <a href="../../python/">Python</a>
</li>
                                    
<li >
    <a href="../../misc/">Misc</a>
</li>
                                    
<li >
    <a href="../../other/">Other</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../about/">Find Us</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#container">Container</a></li>
            <li><a href="#_1">常用顺序存储容器</a></li>
            <li><a href="#_4">常用关联存储容器</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="container">Container</h1>
<h2 id="_1">常用顺序存储容器</h2>
<h3 id="_2">说明</h3>
<pre><code>    QVector        QLinkedList
        \               /
         +----QList----+
                |
     +----------+---------+
     |          |         |
QStringList  QStack     QQueue
</code></pre>

<ul>
<li>QVector: 向量, 类似数组, 存储空间连续, 适合获取随机位置数据或者末尾处添加数据, 不适合中间位置插入删除数据. 可以使用[], append(), &lt;&lt;, 遍历器</li>
<li>QLinkedList: 链表, 适合数据插入删除, 但是随机位置访问比较慢. 可以使用appen(), &lt;&lt;, 遍历器</li>
<li>QList: 同时拥有QVector和QLinkedList大多数有点, <code>尽量使用QList容器替代QVector和QLinkedList</code></li>
<li>QStringList &amp; QStack &amp; QQueue是QList的特例. QStack: push(), pop(), top(). QQueue: enqueue(), dequeue(), head().</li>
</ul>
<h3 id="_3">遍历</h3>
<ul>
<li>使用遍历器和使用foreach</li>
<li>遍历器有两种风格: Java style(风格简单, 返回的是容器中元素) and STL style(功能强大, 返回的是容器中元素的指针)</li>
<li>每种容器类都有对应的两种遍历器: 只读遍历器和读写遍历器</li>
</ul>
<p>Java style:</p>
<pre><code>只读遍历器: QVectorIterator, QLinkedListIterator, QListIterator...
读写遍历器: QMutableVectorIterator, QMutableLinkedListIterator, QMutableListIterator...
</code></pre>

<p>STL style:</p>
<p>对于某些返回容器的函数, 如果使用STL风格遍历器, 需要建立一个返回值的拷贝, 然后再遍历, 来避免调用临时对象的函数
使用Java风格遍历器时不会有这种问题, 因为系统自动为我们创建了这个拷贝(隐式数据共享, 例如QByteArray, QBrush, QFont, QImage, QPixmap, Qstring)</p>
<pre><code>T::iterator
T::const_iterator
</code></pre>

<p><strong>注意</strong></p>
<ul>
<li>例如QList有多种用法赋值, 初始化时候赋值, [], append(), &lt;&lt;, 尽量使用容器时不要使用[]而使用at函数, 因为QMap/QHash等容器中可能会插入一个值但结果并不是自己需要的.</li>
<li>对于顺序存储容器最好一直使用迭代器或foreach, 迭代器也最好使用STL风格的, 因为QT中有隐式数据共享机制(类似kernel中的cow - copy on write), 这种机制在赋值时会让人迷惑</li>
<li>对容器的操作会导致前边定义的迭代器失效, 所以要再使用迭代器时需要重新定义迭代器</li>
<li>对于非const容器, begin()/end()等在数据改变时会进行深复制, 所以尽量使用const_iterator, constBegin()和constEnd</li>
</ul>
<pre><code>QList&lt;int&gt; v = {1, 3, 5, 7, 9};
v[2] = 8;    &lt;===
v.append(11);
v &lt;&lt; 13
</code></pre>

<h3 id="qlist">代码(QList为例)</h3>
<p>Headers:</p>
<pre><code>#include &lt;QList&gt;
#include &lt;QMutableListIterator&gt;
#include &lt;QListIterator&gt;
</code></pre>

<h4 id="java-style">Java style</h4>
<pre><code>QString str;
QList&lt;int&gt; list;

for (int i = 0; i &lt; 10; i ++) {
    list.append(i);
}

QMutableListIterator&lt;int&gt; mutIter(list); // 前边对list的操作会使已经定义的迭代器失效, 所以需要临时定义一个
while (mutIter.hasNext()) { // 由此可见, Java风格的迭代器, 返回的是容器中元素
    mutIter.setValue(mutIter.next() + 3); // to remove item with mutIter.remove()
}

QListIterator&lt;int&gt; iter(list);
while (iter.hasNext()) {
    str += &quot; &quot; + QString::number(iter.next());
}
</code></pre>

<h4 id="stl-style">STL style</h4>
<pre><code>QString str;
QList&lt;int&gt; list;

for (int i = 0; i &lt; 10; i ++) {
    list.append(i);
}

QList&lt;int&gt;::iterator iter = list.begin();
while (iter != list.end()) {
    *iter = *iter + 3; // 由此可见, STL风格迭代器, 返回的是一个容器中元素的指针 iter.isEmpty() to check if empty
    iter ++;
}

QList&lt;int&gt;::const_iterator citer = list.constBegin();
while (citer != list.constEnd()) {
    str += &quot; &quot; + QString::number(*citer);
    citer ++;
}
</code></pre>

<h4 id="foreach">foreach(实际上是一个宏)</h4>
<pre><code>QString str;
QList&lt;int&gt; list;

for (int i = 0; i &lt; 10; i ++) {
    list.append(i);
}

int v;
foreach (v, list) {
    str += &quot; &quot; + QString::number(v);
}                        
</code></pre>

<h2 id="_4">常用关联存储容器</h2>
<h3 id="_5">说明</h3>
<ul>
<li>QMap: 升序存储. [], insert(), value(). 对于非constQMap, 用[]取不存在Key的值会创建这个Key并且Value赋了空值, 所以请使用value()函数</li>
<li>QMultiMap: QMap是单值类型, QMultiMap允许一个key对应多个value</li>
<li>QHash: 内部存储不排序, 查找速度比QMap快. reserve()扩大空间, squeeze()压缩空间</li>
<li>QMultiHash: QHash也是单值类型, QMultiHash允许多值</li>
<li>QCache: 缓存</li>
<li>QSet: 仅存key</li>
</ul>
<h3 id="java-javanextprevious">遍历(遍历关联存储容器最简单的方法是Java风格遍历器, 因为Java风格遍历器的next&amp;previous返回的是键值对)</h3>
<h4 id="java-style_1">Java style</h4>
<pre><code>QString str;
QMap&lt;int, QString&gt; map;
map.insert(2, &quot;22222&quot;);
map.insert(1, &quot;11111&quot;);
map.insert(4, &quot;44444&quot;);
map.insert(3, &quot;33333&quot;);

QMutableMapIterator&lt;int, QString&gt; mmapIter(map);
while(mmapIter.hasNext()) {
    mmapIter.next(); // 如果不使用next返回值
    mmapIter.setValue(mmapIter.value() + &quot; new&quot;);
}

QMapIterator&lt;int, QString&gt; mapIter(map);
while (mapIter.hasNext()) {
    str += &quot;\n&quot; + mapIter.next().value(); // 使用next返回值
}
</code></pre>

<h4 id="stl-style_1">STL style</h4>
<pre><code>QString str;
QMap&lt;int, QString&gt; map;
map.insert(2, &quot;22222&quot;);
map.insert(1, &quot;11111&quot;);
map.insert(4, &quot;44444&quot;);
map.insert(3, &quot;33333&quot;);

QMap&lt;int, QString&gt;::iterator iter = map.begin();
while(iter != map.end()) {
    iter.value() += &quot; new&quot;;
    iter ++;
}

QMap&lt;int, QString&gt;::const_iterator citer = map.constBegin();
while(citer != map.constEnd()) {
    str += &quot;\n&quot; + QString::number(citer.key()) + citer.value();
    citer ++;
}
</code></pre>

<h4 id="foreach_1">foreach</h4>
<p>对于QMap这样的容器如果要使用foreach处理所有key和value的情况, 只能key和value分别循环, 但是有时候没有意义, 例如:</p>
<pre><code>foreach(int k, map.keys()) {
    foreach(QString v, map.values()) {
        str += &quot;\n&quot; + QString::number(k) + v;
    }
}
</code></pre>

<p>可以这样使用:</p>
<pre><code>QString str;
QMap&lt;int, QString&gt; map;
map.insert(2, &quot;22222&quot;);
map.insert(1, &quot;11111&quot;);
map.insert(4, &quot;44444&quot;);
map.insert(3, &quot;33333&quot;);

foreach(int k, map.keys()) {
    QString v = map.value(k);
    if (!v.isEmpty()) {
        str += &quot;\n&quot; + QString::number(k) + &quot;: &quot; + v;
    }
}
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
